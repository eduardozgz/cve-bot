use crate::opencve_schema::cves;
use chrono::{DateTime, Utc};
use diesel::prelude::*;
use serde::Deserialize;
use serde_json::Value;

#[derive(Debug, Queryable, Selectable, Deserialize)]
#[diesel(table_name = cves)]
#[diesel(check_for_backend(diesel::pg::Pg))]
pub struct CVE {
    #[serde(skip)]
    pub id: uuid::Uuid,

    #[serde(skip)]
    pub cve_id: String,

    #[serde(skip)]
    pub created_at: DateTime<Utc>,

    #[serde(skip)]
    pub updated_at: DateTime<Utc>,

    #[serde(skip)]
    pub summary: String,

    #[serde(skip)]
    pub cvss2: Option<f64>,

    #[serde(skip)]
    pub cvss3: Option<f64>,

    pub json: Option<Value>,
    pub vendors: Option<Value>,
    pub cwes: Option<Value>,
}
