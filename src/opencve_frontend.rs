pub const COOL_CVE_EXAMPLE: &str = "CVE-2022-38392";

pub struct OpenCVEFrontend<'a> {
    pub base_url: &'a str,
}

impl OpenCVEFrontend<'_> {
    pub fn new<'a>(
        guild_url: Option<&'a str>,
        channel_url: Option<&'a str>,
        default_url: &'a str,
    ) -> OpenCVEFrontend<'a> {
        OpenCVEFrontend {
            base_url: channel_url.unwrap_or(guild_url.unwrap_or(default_url)),
        }
    }
    pub fn get_cve_url(&self, cve: &str) -> String {
        format!("{}/cve/{}", &self.base_url, cve)
    }

    pub fn get_search_vendor_url(&self, vendor_id: &str) -> String {
        format!("{}/cve?vendor={}", &self.base_url, vendor_id)
    }

    pub fn get_search_product_url(&self, product_id: &str) -> String {
        format!("{}/cve?vendor={}", &self.base_url, product_id)
    }

    pub fn get_search_cwe_url(&self, cwe_id: &str) -> String {
        format!("{}/cve?cwe={}", &self.base_url, cwe_id)
    }
}
